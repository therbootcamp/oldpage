<!DOCTYPE html>
<html>
  <head>
    <title>Statistics</title>
    <meta charset="utf-8">
    <meta name="author" content="The R Bootcamp Twitter: @therbootcamp" />
    <link href="libs/remark-css/example.css" rel="stylesheet" />
    <link rel="stylesheet" href="my-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Statistics
### The R Bootcamp<br/>Twitter: <a href='https://twitter.com/therbootcamp'><span class="citation">@therbootcamp</span></a>
### September 2017

---





# Statistics
.pull-left4[


### In this tutorial we will cover

- The basic structure and arguments of most statistical functions
    - `formula`, `data`, `subset`
    
- Simple `htest` objects

- General linear model, ANOVA

- Using different methods
    - `print()`, `summary()`, `names()`, `predict()`, `plot()`

- Accessing elements from statistical objects

]

.pull-right6[

### Examples


```r
# T-test comparing weights from Diets 1 and 2
t.test(formula = weight ~ Diet,
       data = Chickweight,
       subset = Diet %in% c(1, 2))

# Regression model

weight_glm &lt;- glm(formula = weight ~ .,
                  data = ChickWeight)

# Summary information
summary(weight_glm)

weight_glm$coefficients # Acess coefficients
weight_glm$coefficients # Access residuals
```

]

---
# Basic structure of statistical tests

.pull-left4[

### Formula

- Most statistical functions require a `formula` argument

&gt; `formula = y ~ a + b + ...`

Means...

&gt; Model a dependent variable `y` as a function of `a` and `b` and `...`

- Formulas go together with dataframes `data` containing all variables in the formula.

]

.pull-right6[

### General structure of a hypothesis test and formula


```r
my.test(formula = y ~ a + b, # Formula
        data = my.data,      # Dataframe
        ...                  # Additional
        )
```

- `y` is the dependent variable (e.g.; age), `a` and `b` are independent variables
- `data` is a dataframe containing the variables in `formula`; (`y`, `a`, `b`)
-  `...` additional arguments specific to test
]

---

.pull-left4[

## Regression example with `glm()`


```r
head(ChickWeight)
```

```
##   weight Time Chick Diet
## 1     42    0     1    1
## 2     51    2     1    1
## 3     59    4     1    1
## 4     64    6     1    1
## 5     76    8     1    1
## 6     93   10     1    1
```

**Goal**: Create a regression model predicting `weight` as a function of Time

&lt;br&gt;
`$$\Large weight = \beta_{0} + \beta_{1} \times Time + \epsilon$$`
]

.pull-right55[


- Function: `glm()`
- Formula: `formula = weight ~ Time`
- Data: `data = ChickWeight`


```r
# Create a glm object 

# formula: weight ~ Time
# data: ChickWeight

chick_glm &lt;- glm(formula = weight ~ Time,
                 data = ChickWeight)


# Print the object
chick_glm
```

```
## 
## Call:  glm(formula = weight ~ Time, data = ChickWeight)
## 
## Coefficients:
## (Intercept)         Time  
##        27.5          8.8  
## 
## Degrees of Freedom: 577 Total (i.e. Null);  576 Residual
## Null Deviance:	    2910000 
## Residual Deviance: 872000 	AIC: 5880
```
]


---

.pull-left7[
## Using formulas

You can keep adding terms with `+` 


```r
# Include multiple terms with +
chick_glm_A &lt;- glm(formula = weight ~ Time + Diet + Chick,
                   data = ChickWeight)
```

To include *all* variables, use the generic notation &lt;font color = "blue"&gt; `formula = y ~ .`&lt;/font&gt;


```r
# Use  y ~ . to include ALL variables
chick_glm_B &lt;- glm(formula = weight ~ .,
                   data = ChickWeight)
```

To include *interaction terms* use `*`


```r
# Include an interaction term between Time and Diet
chick_glm_C &lt;- glm(formula = weight ~ Time * Diet + Chick,
                   data = ChickWeight)
```

]



---

.pull-left35[


&lt;br&gt;&lt;br&gt;

## Exploring statistical objects

You can apply many *generic* functions to statistical objects such as `print()`, `summary()`, `predict()` and `plot()`.



```r
# Create statistical object
my_obj &lt;- FUN(formula = ...,
              data = ...)

print(my_obj)       # Print
summary(my_obj)     # Summary
plot(my_obj)        # Plotting
predict(my_obj, ..) # Predict
```

]

.pull-right6[
&lt;br&gt;&lt;br&gt;
**Apply generic functions to a statistical object**


```r
# Create a glm object
chick_glm &lt;- glm(formula = weight ~ Time,
                 data = ChickWeight)

# Print the object
print(chick_glm)
```

```
## 
## Call:  glm(formula = weight ~ Time, data = ChickWeight)
## 
## Coefficients:
## (Intercept)         Time  
##        27.5          8.8  
## 
## Degrees of Freedom: 577 Total (i.e. Null);  576 Residual
## Null Deviance:	    2910000 
## Residual Deviance: 872000 	AIC: 5880
```



]

---

.pull-left35[

## Exploring statistical objects

The output of a statistical function is always a list with many named elements.

Different statistical objects have different **classes** with different outputs.

To see what is inside of a statistical object, use the `names()` function:

Once you know the names of the elements, use `$` to access them!

]

.pull-right6[


```r
chick_glm &lt;- glm(formula = weight ~ Time + Diet,
                 data = ChickWeight)

# What class is this object?
class(chick_glm)
```

```
## [1] "glm" "lm"
```

```r
# What are the named elements?
names(chick_glm)
```

```
##  [1] "coefficients"      "residuals"         "fitted.values"     "effects"           "R"                
##  [6] "rank"              "qr"                "family"            "linear.predictors" "deviance"         
## [11] "aic"               "null.deviance"     "iter"              "weights"           "prior.weights"    
## [16] "df.residual"       "df.null"           "y"                 "converged"         "boundary"         
## [21] "model"             "call"              "formula"           "terms"             "data"             
## [26] "offset"            "control"           "method"            "contrasts"         "xlevels"
```

```r
# Access the coefficients
chick_glm$coefficients
```

```
## (Intercept)        Time       Diet2       Diet3       Diet4 
##       10.92        8.75       16.17       36.50       30.23
```

]


---

.pull-left5[

## Common statistical modelling functions

| Test| R Function|
|------:|----:|
|     T-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     Chi-Square Test|   `chisq.test()`|
|     Simple regression|    `lm()`|
|     General Linear Model|    `glm()`|



### Check help menus!


- Different statistical functions require different arguments.

- Look at the help menus to know exactly what arguments each function needs.

]


.pull-right5[

#### Always check help menus!


`?t.test`

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/ttesthelp_ss.png" width="80%" style="display: block; margin: auto;" /&gt;



]







---
# Two types of statistics: Descriptive and Inferential

.pull-left4[

### Inferential

- Used to make inferences about a larger population. Typically done in tandem with a *hypothesis test*

#### Examples

| Hypothesis Test| R Function|
|------:|----:|
|     T-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     Chi-Square Test|   `chisq.test()`|
|     ANOVA, Post-hoc|    `aov(), TukeyHSD()`|

- Hypothesis tests typically return lists of outputs (e.g.; p-value, test statistic)


]

.pull-right55[
#### R implimentation


```r
t.test(x = c(4, 3, 6, 5, 3, 2),
       mu = 0,
       alternative = "two.sided")
```

```
## 
## 	One Sample t-test
## 
## data:  c(4, 3, 6, 5, 3, 2)
## t = 6.4, df = 5, p-value = 0.001
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  2.289 5.378
## sample estimates:
## mean of x 
##     3.833
```


]






---
# Inferential Statistics

.pull-left6[

### Different tests, different arguments

- A one-sample t-test requires just a vector, while an ANOVA requires more arguments.
- To see what arguments a test needs, consult the help menu (e.g.; `?t.test`)

#### Examples

| Hypothesis Test| Help code|
|------:|:----|
|     T-test|    `?t.test()`|
|     Correlation Test|    `?cor.test()`|
|     Chi-Square Test|   `?chisq.test()`|
|     ANOVA|    `?aov()`|
]

.pull-right3[
#### Always check help menus!

`?t.test`

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/ttesthelp_ss.png" width="80%" style="display: block; margin: auto;" /&gt;

]




---
# Inferential Statistics

.pull-left5[

### Arguments to hypothesis tests

- Some arguments are manditory, and some are optional.
    - If you don't specify an optional argument, R will use a *default* value

#### Ex) Arguments to `t.test`

| Argument| Description| Default |
|------:|----:|:---|
|    `x`, `formula, data`|Vector OR a formula and data | *Required* |
|     `mu`|   Null hypothesis| 0 |
|     `alternative`| Alternative Hyp| `"two.sided"`| 
]

.pull-right45[

### Specifying arguments to a hypothesis test


```r
# 0: Won't work!
t.test()

# 1: Will work and use default arguments
t.test(x = ChickWeight$weight)

# 1b: Same as above
t.test(x = ChickWeight$weight,
       mu = 0,
       alternative = "two.sided")

# 2: Specified arguments
t.test(x = ChickWeight$weight,
       mu = 120,
       alternative = "greater")
```


]




---
# Inferential Statistics

.pull-left5[

### Assigning hypothesis test objects

- Most hypothesis tests return an object of class `"htest"` which contain many values
- You can assign the results of a hypothesis test to an object, and then extract the info you want with the `$` operator:

#### Examples of what's in htest objects

| Element| Result|
|------:|----:|
|    `x$statistic`|    A test statistic|
|     `x$parameter`|    Degrees of freedom|
|     `x$p.value`|   The p-value|
|     `x$conf.int`|  Confidence interval|
]

.pull-right5[
### What's in an htest object?


```r
# One-sample t-test

weight.tt &lt;- t.test(x = ChickWeight$weight,
                    mu = 120,
                    alternative = "two.sided")

class(weight.tt)
```

```
## [1] "htest"
```

```r
# What's in the weight.tt object?
names(weight.tt)
```

```
## [1] "statistic"   "parameter"   "p.value"     "conf.int"    "estimate"    "null.value"  "alternative"
## [8] "method"      "data.name"
```


]



---
# Examples with ChickWeight Data

.pull-left4[


```r
ChickWeight
```


```
##   weight Time Chick Diet
## 1     59    4    30    2
## 2     93    8    26    2
## 3     79    6    40    3
## 4    145   12    28    2
## 5     48    4     5    1
## 6    148   18    22    2
```



]


.pull-right55[

![Source: http://awallpapersimages.com/wp-content/uploads/2016/07/Chicken-cute-baby-image.jpg](https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/cutechicken.jpg)

]

---
# t-tests with `t.test()`

.pull-left3[

### ChickWeight data

```r
ChickWeight
```



```
##   weight Time Chick Diet
## 1     59    4    30    2
## 2     93    8    26    2
## 3     79    6    40    3
## 4    145   12    28    2
## 5     48    4     5    1
## 6    148   18    22    2
```


]

.pull-right65[

### One sample t-test

&gt; Is the mean weight of the chicks significantly different from 120?


```r
t.test(x = ChickWeight$weight,      # Vector of values 
       alternative = "two.sided",   # Two sided test
       mu = 120)                    # Null is 120
```

```
## 
## 	One Sample t-test
## 
## data:  ChickWeight$weight
## t = 0.62, df = 580, p-value = 0.5
## alternative hypothesis: true mean is not equal to 120
## 95 percent confidence interval:
##  116.0 127.6
## sample estimates:
## mean of x 
##     121.8
```

]

---
# t-tests with `t.test()`

.pull-left3[

### ChickWeight data

```r
ChickWeight
```


```
##   weight Time Chick Diet
## 1     59    4    30    2
## 2     93    8    26    2
## 3     79    6    40    3
## 4    145   12    28    2
## 5     48    4     5    1
## 6    148   18    22    2
```

]

.pull-right65[

### Two sample t-test

&gt; Is the mean weight of the chicks on Diet 1 different from Diet 2?


```r
t.test(formula = weight ~ Diet,    # Formula
       data = ChickWeight,         # Data in Chickweight
       subset = Diet %in% c(1, 2)) # Only Diets 1,2
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  weight by Diet
## t = -2.6, df = 200, p-value = 0.009
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -34.900  -5.042
## sample estimates:
## mean in group 1 mean in group 2 
##           102.6           122.6
```

]

---
# Correlation test with `cor.test()`

.pull-left3[

### ChickWeight data

```r
ChickWeight
```



```
##   weight Time Chick Diet
## 1     59    4    30    2
## 2     93    8    26    2
## 3     79    6    40    3
## 4    145   12    28    2
## 5     48    4     5    1
## 6    148   18    22    2
```

]

.pull-right6[

### Correlation Test

&gt; Is there a correlation between weight and Time?

- For `cor.test()`, formula looks like `formula = ~ a + b`


```r
cor.test(formula = ~ weight + Time, # Formula
         data = ChickWeight)          # Data in Chickweight
```

```
## 
## 	Pearson's product-moment correlation
## 
## data:  weight and Time
## t = 37, df = 580, p-value &lt;2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8109 0.8599
## sample estimates:
##    cor 
## 0.8371
```

]



---
# Chi-Square test with `chisq.test()`

.pull-left3[

### ChickWeight data

```r
ChickWeight
```



```
##   weight Time Chick Diet
## 1     59    4    30    2
## 2     93    8    26    2
## 3     79    6    40    3
## 4    145   12    28    2
## 5     48    4     5    1
## 6    148   18    22    2
```


]

.pull-right6[

### Chi-Square test

&gt; Are there more observations from one Diet than another?

- For `chisq.test()`, main argument should be a table of values created from the `table()` function:


```r
chisq.test(x = table(ChickWeight$Diet))
```

```
## 
## 	Chi-squared test for given probabilities
## 
## data:  table(ChickWeight$Diet)
## X-squared = 53, df = 3, p-value = 2e-11
```

]

---
# ANOVA with `aov()`

.pull-left3[

### ChickWeight data

```r
ChickWeight
```


```
##   weight Time Chick Diet
## 1     59    4    30    2
## 2     93    8    26    2
## 3     79    6    40    3
## 4    145   12    28    2
## 5     48    4     5    1
## 6    148   18    22    2
```

]

.pull-right6[

### ANOVA

&gt; Is there difference in weights based on Diet?

- Applying `summary()` to an `aov` object prints a nice table.


```r
E &lt;- aov(formula = weight ~ Diet, # Formula
         data = ChickWeight)      # Data in Chickweight

summary(E)  # Sow a summary of the results
```

```
##              Df  Sum Sq Mean Sq F value  Pr(&gt;F)    
## Diet          3  155863   51954    10.8 6.4e-07 ***
## Residuals   574 2758693    4806                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

]

---
# Post-hoc tests with `TukeyHSD()`

.pull-left4[

&gt; Which specific pairs of Diets differed?

### Step 1: Create aov object

- Apply `TukeyHSD()` to an `aov` object to get post-hoc tests.


```r
# Create an aov object called D

D &lt;- aov(formula = weight ~ Diet,
         data = ChickWeight)
```

]

.pull-right55[

### Step 2: Apply `TukeyHSD()` to object

```r
TukeyHSD(D)  # Conduct post-hoc tests
```

```
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = weight ~ Diet, data = ChickWeight)
## 
## $Diet
##       diff      lwr   upr  p adj
## 2-1 19.971  -0.2998 40.24 0.0552
## 3-1 40.305  20.0335 60.58 0.0000
## 4-1 32.617  12.2354 53.00 0.0003
## 3-2 20.333  -2.7268 43.39 0.1058
## 4-2 12.646 -10.5116 35.80 0.4954
## 4-3 -7.687 -30.8450 15.47 0.8278
```

]


---
# Final notes

.pull-left7[

- When using a hypothesis test, always ask:

&gt; What are the arguments?

&gt; What format or class should the arguments be?

- When in doubt, always look at the help files and examples at the end.

- Save hypothesis tests as new objects, then apply `names()` to see what elements it contains, then extract what you want with `$`


```r
# Run test and save as test_A
test_A &lt;- t.test(formula = weight ~ Diet,
                 data = ChickWeight,
                 subset = Diet %in% c(1, 2))

names(test_A)  # What is in the object?

test_A$statistic # Ah ok! Show me the test statistic
```



]

.pull-right25[

`?t.test`

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/ttesthelp_ss.png" width="100%" style="display: block; margin: auto;" /&gt;

#### Questions?

]




---

## Statistics Pratical

&lt;p&gt;&lt;font size=6&gt;&lt;b&gt;&lt;a href="https://therbootcamp.github.io/_sessions/D2S2_Statistics/Statistics_practical.html"&gt;Link to Statistics practical&lt;/a&gt;


---
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});
(function() {var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler"); if (!r) return; s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }"; d.head.appendChild(s);})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
