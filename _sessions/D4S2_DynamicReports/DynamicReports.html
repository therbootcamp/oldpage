<!DOCTYPE html>
<html>
  <head>
    <title>Dynamic Reports</title>
    <meta charset="utf-8">
    <meta name="author" content="The R Bootcamp Twitter: @therbootcamp" />
    <link href="libs/remark-css/example.css" rel="stylesheet" />
    <link rel="stylesheet" href="my-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Dynamic Reports
## With RMarkdown
### The R Bootcamp<br/>Twitter: <a href='https://twitter.com/therbootcamp'><span class="citation">@therbootcamp</span></a>
### January 2018

---









## What is a dynamic report?

.pull-left35[

A dynamic report is a document that is, to  *automatically generated* from a combination of data, code, images, and text.

### R Code

- Access Data
- Wrangling / Statistics
- Plots

### Text and formatting

- Regular Text for the reader.
- Formatting.

]

.pull-right6[
http://timelyportfolio.github.io/rCharts_nyt_home_price/
&lt;iframe src="http://timelyportfolio.github.io/rCharts_nyt_home_price/" width="800" height="500"&gt;&lt;/iframe&gt;
&lt;br&gt;
&lt;a href="http://timelyportfolio.github.io/rCharts_nyt_home_price/"&lt;/a&gt;

]

---
## Why use dynamic reports?

.pull-left4[
&lt;br&gt;&lt;br&gt;

&lt;font size = 6&gt;1. Reproducibility&lt;/font&gt;&lt;br&gt;

Anyone should be able to reproduce your results because the code is contained in the final document

- The code *must* be correct because it is being run as the report is created.
- Anyone, even your future self, can replicate your analyses.


&lt;font size = 6&gt;2. Efficiency&lt;/font&gt;&lt;br&gt;

- If you get new data, you can easily create new analyses.


]

.pull-right55[

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/reproducibility_images.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---
## What dynamic reports can I make in R?

.pull-left45[
&lt;br&gt;&lt;br&gt;

|  | |
|:------|:------|
|Web (HTML) pages |[Websites from Markdown](http://rmarkdown.rstudio.com/rmarkdown_websites.html) |
|PDF documents | [PDFs from Markdown](http://rmarkdown.rstudio.com/pdf_document_format.html) |
|Slideshows | [Slide Ninja from xaringan!](https://github.com/yihui/xaringan) |
|Shiny Apps | [https://shiny.rstudio.com/](https://shiny.rstudio.com/) |
|Books | [bookdown.org](http://bookdown.org) |
|R Packages | [Wickham package writing guide](http://r-pkgs.had.co.nz/) |


### Underneath everything...

# R Markdown

]

.pull-right45[

R Markdown lets you create almost anything from R!

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/RMarkdownOutputFormats.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---
## What is Markdown?

- Markdown is a simple, readable **markup language** that allows you to easily write text with special formatting **tags**, which are then converted to formatted outputs.

- **R Markdown** is a combination of Markdown and R code.

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/markdown_ss.png" width="50%" style="display: block; margin: auto;" /&gt;

---
## How do I write an R Markdown Document

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/openmarkdown.png" width="80%" style="display: block; margin: auto;" /&gt;

---
## R Markdown = Markdown + R code

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/markdown_example.png" width="45%" style="display: block; margin: auto;" /&gt;

---
## R Markdown = Markdown + R code

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/rmarkdown_ss2.png" width="70%" style="display: block; margin: auto;" /&gt;


---
## Cheatsheet

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/markdown_cheat.png" width="50%" style="display: block; margin: auto;" /&gt;

&lt;a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf"&gt;https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf&lt;/a&gt;



---
## R Markdown = Markdown + R code

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/knitto.png" width="70%" style="display: block; margin: auto;" /&gt;

---
## R Markdown Gallery

http://rmarkdown.rstudio.com/gallery.html

&lt;iframe src="rmarkdown_gallery.htm" width="800" height="450"&gt;&lt;/iframe&gt;


---
## Output types

.pull-left4[

- There are *many* different output formats you can create from an R Markdown document

- Many come with RStudio, many are distributed in packages:

| Package|Description|
|:------|:----|
|     `xaringan`*| Slideshows (like this one!)|
|     `papaja`*|APA Manuscripts|
|     `rmdformats`|Many templates|
|     `prettydoc`|Many templates|

* = On GitHub

]

.pull-right55[

### R Markdown templates in R Studio

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/rmarkdown_templates.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---
## To write to PDF, you need TeX

.pull-left3[


RMarkdown uses LaTeX to create PDF files

In order to knit your document to a PDF, you'll need a TeX installation on your machine.

| OS | Link |
|:---|:----|
|Windows| MiKTeX [https://miktex.org/download](https://miktex.org/download)
|Mac| MacTeX [http://www.tug.org/mactex/](http://www.tug.org/mactex/)


]

.pull-right65[

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/latex_collage.png" width="70%" style="display: block; margin: auto;" /&gt;

]


---
## Code Chunks in R Markdown

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/chunkoptions.png" width="60%" style="display: block; margin: auto;" /&gt;

---
## Code Chunks in R Markdown

- You can set default chunk options with `ops_chunk$set()`. When you do, all future chunks will have these settings (unless you specify otherwise)


```r
# Example: Set default values for ALL future chunks
#   with knitr::ops_chunk$set


knitr::opts_chunk$set(fig.width = 6,        # Figure width (in)
                      fig.height = 6,       # Figure height (in)
                      echo = TRUE,          # Repeat code
                      eval = TRUE,          # Evaluate chunks
                      message = FALSE,      # Don't print messages
                      warning = FALSE,      # Don't print warnings
                      fig.align = 'center') # Center figures
```

- We recommend setting chunk options at the beginning of each document!

---
## Inline chunks

- You can also include *inline chunks* where R code is included in a sentence. This allows you to include R output in your text!

&lt;br&gt;
&lt;br&gt;

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/minichunk_ss_D.png" width="70%" style="display: block; margin: auto;" /&gt;

---
## Inline chunks

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/minichunk_big_ss.png" width="100%" style="display: block; margin: auto;" /&gt;


---
## Key points in R Markdown

.pull-left3[

&lt;br&gt;
&lt;br&gt;

1. When you "Knit" an R markdown document, it will start with an *empty* workspace (ie. it will forget everything!)

2. You must explicitly load all packages with `library()` and load in external datasets (e.g.; `clinical_data &lt;- read_csv("data/data.csv")`)

3. If you have any typos, errors, or missing code, the document will *not* knit (this is a *good* thing!)

]

.pull-right6[

#### Well formatted R Markdown document

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/wellformattedmarkdown.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---
## Keep your projects tidy

.pull-left4[

&lt;br&gt;
&lt;br&gt;


1. You can easily read in external files like images, R code, or datasets in your document.

2. All external files should be in a folder in the "Root" Directory containing the Markdown (.Rmd) file

3. All data necessary for your report *must* be explicitly read into the document. So keep them close by!

]

.pull-right55[

#### Here is the "Root" directory of the R Markdown file `dynamicreports.Rmd` that created *this* presentation

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/rmarkdown_directory.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---
## Managing working directories with RMarkdown

.pull-left4[

When you knit a \*.Rmd file, the working directory will be *temporarily changed to the location of that file*.

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/wd_ss.png" width="70%" style="display: block; margin: auto;" /&gt;


If your Markdown file is **not** in the root working directory of your project (is in a folder), then your code may no longer work.


]

.pull-right55[

This code might work when you evaluate it directly in your RStudio session


```r
mydata &lt;- read_csv(file = "data/mydata.csv")
```

But when you **knit** the document, you might see an error like this:

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/error_wd.png" width="90%" style="display: block; margin: auto;" /&gt;

]

---
## Managing working directories with RMarkdown


&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/markdown_wd_A.png" width="90%" style="display: block; margin: auto;" /&gt;

---
## Managing working directories with RMarkdown


&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/markdown_wd_B.png" width="90%" style="display: block; margin: auto;" /&gt;

---
## Managing working directories with RMarkdown


&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/markdown_wd_C.png" width="90%" style="display: block; margin: auto;" /&gt;


---
## Rendering output with `knitr`

.pull-left45[

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/knitr_hex.png" width="30%" style="display: block; margin: auto;" /&gt;

- Output such as images and tables need to be explicitly *rendered*. Do this using the `knitr` package.

- The two most useful `knitr` functions are `include_graphics()` and `kable()`

| Function|Output|
|:------|:----|
|     `include_graphics(path)`| Include an external image (e.g.; .png, .jpg)|
|     `kable(df, format)`|Include a dataframe as a table|

]

.pull-right45[

### Print a dataframe as a table with `kable()`


```r
kable(economics[1:3, c("date", "pop")], 
      format = 'markdown')
```



|date       |    pop|
|:----------|------:|
|1967-07-01 | 198712|
|1967-08-01 | 198911|
|1967-09-01 | 199113|

### Include an image


```r
include_graphics(path = "images/rlogo.png")
```

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/rlogo.png" width="20%" style="display: block; margin: auto;" /&gt;

]


---
## R Packages - The ultimate dynamic report?

.pull-left55[

If you want a fully contained, dynamic report that contains data, code, statistics, plots, text, help files and documentation that you can easily share, your answer may be creating an **R Package**.

#### Installing an example package from GitHub


```r
library(devtools) # For the install_github function

# Install DrugX_2018_Trial package from github
install_github("bootcamp/DrugX_2018_Trial")

# Load DrugX_2018_Trial package
library("DrugX_2018_Trial")

# Open DrugX_2018_Trial package help
?DrugX_2018_Trial
```

]

.pull-right4[

### Package folder structure

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/phillips2017_package_ss.png" width="100%" style="display: block; margin: auto;" /&gt;

&lt;br&gt;

Read Wickham's [book "R Packages"](http://r-pkgs.had.co.nz/) (available free at this link) to learn how to write your own package.

]


---
## Why are dynamic documents so great?

.pull-left45[

&lt;br&gt;
&lt;br&gt;

1. The data, code, and output are all in the same place.

2. Everything works and is replicable! (If it wasn't, the document wouldn't *Knit*!)

3. You can produce great looking documents, from simple PDFs, to webpages, to presentations (like this one), to books.

]

.pull-right45[

&lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/markdown_complete.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Dynamic Reports Pratical

&lt;p&gt;&lt;font size=6&gt;&lt;b&gt;&lt;a href="https://therbootcamp.github.io/_sessions/D4S2_DynamicReports/DynamicReports_practical.html"&gt;Link to Dynamic Reports practical&lt;/a&gt;


---
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});
(function() {var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler"); if (!r) return; s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }"; d.head.appendChild(s);})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
